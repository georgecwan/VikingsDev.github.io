<!DOCTYPE html>
<html lang="en">
<head>
    <title>VikingsDev</title>
    <link rel="icon" href="../images/logos/vikingsdev-icon.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,,500,600,700" rel="stylesheet">

    <link rel="stylesheet" href="../css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="../css/animate.css">

    <link rel="stylesheet" href="../css/owl.carousel.min.css">
    <link rel="stylesheet" href="../css/owl.theme.default.min.css">
    <link rel="stylesheet" href="../css/magnific-popup.css">

    <link rel="stylesheet" href="../css/aos.css">

    <link rel="stylesheet" href="../css/ionicons.min.css">

    <link rel="stylesheet" href="../css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="../css/jquery.timepicker.css">


    <link rel="stylesheet" href="../css/flaticon.css">
    <link rel="stylesheet" href="../css/icomoon.css">
    <link rel="stylesheet" href="../css/style.css">
</head>
<script src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script><body>

<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
    <div class="container">
        <a href="../index.html"><img src="../images/logos/vikingsdev-logo.png"></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
                aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="oi oi-menu"></span> Menu
        </button>

        <div class="collapse navbar-collapse" id="ftco-nav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a href="../index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="../about.html" class="nav-link">About</a></li>
                <li class="nav-item"><a href="../events.html" class="nav-link">Events</a></li>
                <li class="nav-item"><a class="nav-link" href="../leaderboard.html">Bounties</a></li>
                <li class="nav-item active"><a class="nav-link" href="../workshops.html">Workshops</a></li>
                <li class="nav-item"><a href="../contact.html" class="nav-link">Contact</a></li>
                <li class="nav-item cta"><a href="../signup.html" class="nav-link"><span>Sign Up</span></a></li>
            </ul>
        </div>
    </div>
</nav>
<!-- END nav -->



<div class="hero-wrap hero-wrap-2" style="background-image: url('https://static.xx.fbcdn.net/rsrc.php/v3/yh/r/p6_sqYxQ9ch.png');"
     data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text align-items-end justify-content-start">
            <div class="col-md-8 ftco-animate text-center text-md-left mb-5">
                <p class="breadcrumbs mb-0"><span class="mr-3"><a href="../index.html">Home <i
                        class="ion-ios-arrow-forward"></i></a><a href="../workshops.html"> Workshops<i
                        class="ion-ios-arrow-forward"></i></a></span> <span>PYTHON MESSENGER BOT</span></p>
                <h1 class="mb-3 bread">Python Messenger Bot</h1>
                <h3 class="mb-3 bread">George Wan</h3>
            </div>
        </div>
    </div>
</div>

<br><br>
<p class="text-center sticky-top float-right" style="top:90vh; right:20px;"><a href="https://discord.gg/JTRFMx2" class="btn btn-primary py-3">Get Help</a></p>

<div class="card" style="margin: 0 auto; display: block; max-width: 500px; padding:20px">
    <p class="toc_title">Table of Contents</p>
    <ul class="toc_list">
        <li><a href="#first">Setting up the environment</a>
            <!--            <ul>-->
            <!--                <li><a href="#First_Sub_Point_1">1.1 First Sub Point 1</a></li>-->
            <!--                <li><a href="#First_Sub_Point_2">1.2 First Sub Point 2</a></li>-->
            <!--            </ul>-->
        </li>
        <li><a href="#second">Creating a command</a></li>
        <li><a href="#third">Running the bot</a></li>
        <li><a href="#fourth">Pushing the command</a></li>
    </ul>
</div>

<section class="ftco-section testimony-section">
    <div class="container">
        <div class="row justify-content-center mb-5 pb-3">
            <div class="col-md-7 heading-section ftco-animate">
                <p>In this workshop, I will be showing you how to make commands on the VikingsDev messenger bot.</b></p>
                <div class="card" style="border-color: orange; background-color: lightgoldenrodyellow; padding: 20px;">
                    <img src="../images/workshop-icons/alert-orange.png" style="width: 50px; margin: 0 auto;">
                    <br>
                    <b class="text-center">You need a GitHub account to complete this workshop.</b>
                </div>
                <br>
                <p>If you do not have a GitHub account yet, please click the button below to sign up.</p>
                <p class="text-center"><a target="_blank" href="https://github.com/join" class="btn btn-primary py-3">Register
                    for GitHub</a></p>
                <div class="card" style="border-color: orange; background-color: lightgoldenrodyellow; padding: 20px;">
                    <img src="../images/workshop-icons/alert-orange.png" style="width: 50px; margin: 0 auto;">
                    <br>
                    <b class="text-center">You need a Python IDE to complete this workshop.</b>
                </div>
                <br>
                <p>If you do not have a Python IDE, you can try downloading Atom. Alternatively, you may also use any other IDE
                  that you may prefer if it supports Python. Make sure that you know the basic functions of the IDE of your choice.</p>
                <p class="text-center"><a target="_blank" href="https://atom.io/" class="btn btn-primary py-3">Download Atom</a></p>
                <h2 id="first" class="text-center">Setting up the environment</h2>
                <p>First, login to GitHub and go to the <a target="_blank" href="https://github.com/VikingsDev/Dentaku">VikingsDev Dentaku repository</a>.
                    Fork the VikingsDev bot by clicking the "Fork" button on the top right.</p>
                <img style="width:100%" src="dentaku-assets/fork-repo.png">
                <br><br>
                <p>
                  You should now be inside your own fork. To make sure, check the title of the repository. It should be YOUR_USERNAME / Dentaku and
                  say "forked from VikingsDev/Dentaku" in the subtitle. We will need to clone this repository so click the green "Clone or download" button
                  on the right and click the clipboard to the right of the URL to copy it.
                </p>
                <img style="width:100%" src="dentaku-assets/clone-repo.png">
                <br><br>
                <p>
                  Find the Terminal application (it should be in your applications folder) and open it. A command line should pop up in a new window.
                  Type 'git clone' followed by the URL you have copied and then press enter:
                </p>
                <pre><code>git clone https://github.com/YOUR_USERNAME/Dentaku.git</code></pre>
                <p>
                  This should have created a folder named "Dentaku" in your user folder. To access it, type:
                  <pre><code>cd Dentaku</code></pre>
                </p>
                <p>
                  The command line should now say: Dentaku USERNAME$. For the next step, we will need to use pip.
                  To check if you have pip installed, type 'pip' and then press enter. Sometimes, you may have to
                  type 'pip3'. If both of these commands return 'command not found', you will need to install pip.
                  Click the button below and follow the instructions to install pip.
                </p>
                <p class="text-center"><a target="_blank" href="https://pip.pypa.io/en/stable/installing/" class="btn btn-primary py-3">Install pip</a></p>
                <p>
                  Now, we need to set up a virtual environment. Type the following code. If you had to type 'pip3' instead of 'pip'
                  in the last step, you will need to type 'python3' instead of 'python' for the remainder of this workshop.
                </p>
                <div class="codeheader codeheader-bash">BASH</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
python -m venv venv
                    </code></pre>
                </div>
                <p>
                  If the command did not work, you may have to type <code>pip install virtualenv</code> first. To check if you have
                  successfully created a virtual environment, you can type <code>ls</code> and look for a 'venv' folder.
                </p>
                <p>
                  Next, we will need to create an export file. Type <code>touch export.sh</code> to create the file and then open
                  the file using a text editor of your choice. The file should be located in your Dentaku folder. You will need to
                  fill in the following information:
                </p>
                <div class="codeheader codeheader-bash">BASH</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
export EMAIL="YOUR_FACEBOOK_ACCOUNT_EMAIL"
export PASSWORD="YOUR_FACEBOOK_ACCOUNT_PASSWORD"
export BITLY_GAT="YOUR_BITLY_GENERIC_ACCESS_TOKEN"
export G_CREDENTIALS="PATH_TO_YOUR_SERVICE_ACCOUNT_JSON"
                    </code></pre>
                </div>
                <p><i>
                  Note: You only need to export BITLY_GAT variable if you wish to use commands with link shorteners.
                  Similarly, G_CREDENTIALS are only required if you want to use Google Cloud integration.
                  Make sure you remember to save the file!
                </i></p>
                <p>
                  We will now have to enter the virtual environment we made earlier. Once inside the virtual environment,
                  those that have been using 'pip3' can now use 'pip' instead.
                </p>
                <div class="codeheader codeheader-bash">BASH</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
source venv/bin/activate
pip install -r requirements.txt
                    </code></pre>
                </div>
                <p>
                  The first line of code activates the virtual environment. A (venv) should appear at the beginning of your command line
                  to signal that you are now in the virtual environment. The second line will install all the packages you will need from
                  a list in the file 'requirements.txt'. In the future, you will need to add any new modules that your command needs to
                  'requirements.txt'. You will need to have your Python IDE open for the next steps, but don't close Terminal yet.
                  We will need it again later.
                </p>
                <br>
                <h2 id="second" class="text-center">Creating a command</h2>
                <p>Now we can start making out first command! Open the Dentaku folder as a project in your IDE. For most IDEs, the open option will be in the file tab.
                  Locate the commands folder inside Dentaku. There should already be many pre-made commands inside. This folder will be where we add our own commands.</p>
                <p>Create a new file in the commands folder. (This can usually be done by right-clicking the commands folder in your IDE.) Name the file <b>greet.py</b>.
                  This file will run when the user sends !greet on messenger. At the beginning of every file, you will need to add the following code.
                  Try adding it to greet.py right now!</p>
                <div class="codeheader codeheader-python">PYTHON</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
from command import Command
from fbchat import Message
from fbchat import Mention
                    </code></pre>
                </div>
                <p>As your commands get more complicated, you may have to import other modules as well. For now, this will do.
                    Now, we can move onto the actual command itself. We now have to create a class and a run method to code our command in.
                    Both your class and file should have the same name, otherwise the command will not trigger properly.
                    Your code should now look like this:</p>
                    <div class="codeheader codeheader-python">PYTHON</div>
                    <div class="codebox">
                        <pre><code data-language="python">
                        <p style="color: #fff;">
from command import Command
from fbchat import Message
from fbchat import Mention


class greet(command):

  def run(self):
                        </code></pre>
                    </div>
                <p>The code inside the method will be the code that is run when the command is called. Make two variables,
                  response_text and mentions. We will only concern ourselves with changing the response_text variable. It is
                  the text that will be sent by the bot after the command is called. To be clear with who the bot is replying
                  to, responses from the bot will always start with @user where 'user' is name of the person who triggered the command.
                  Make the variables with the following code inside the run method:
                <div class="codeheader codeheader-python">PYTHON</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
def run(self):
  mentions = [Mention(self.author_id, length=len(self.author.first_name) + 1)]
  response_text = "@" + self.author.first_name + " Hello!"
                    </code></pre>
                </div>
                <p>
                  This will cause Dentaku to say 'Hello!' to whoever triggered the command. (ex. @Steve Hello!)
                  We still need to add the code to send the message. Add the following at the end of all of your run methods.
                </p>
                <div class="codeheader codeheader-python">PYTHON</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
self.client.send(
  Message(text=response_text, mentions=mentions),
  thread_id=self.thread_id,
  thread_type=self.thread_type
)
                    </code></pre>
                </div>
                <p>There's one last thing we need to do. To help others understand how to use a command, we can create a method
                  named define_documentation. For our command, there are no parameters and the command says hello. This information
                  will be shown automatically if someone uses the !help command.</p>
                <div class="codeheader codeheader-python">PYTHON</div>
                <div class="codebox">
                  <pre><code data-language="python">
                  <p style="color: #fff;">
def define_documentation(self):
  self.documentation = {
    "parameters": "NONE",
    "function": "Greets the user with a friendly hello."
  }
                  </code></pre>
                </div>
                <p>Now our command is complete! The file should look exactly like the code below. Let's try running the bot so that we can test it out.</p>
                <div class="codeheader codeheader-python">PYTHON</div>
                <div class="codebox">
                  <pre><code data-language="python">
                  <p style="color: #fff;">
from command import Command
from fbchat import Message
from fbchat import Mention


class greet(command):

  def run(self):
    mentions = [Mention(self.author_id, length=len(self.author.first_name) + 1)]
    response_text = "@" + self.author.first_name + " Hello!"
    self.client.send(
      Message(text=response_text, mentions=mentions),
      thread_id=self.thread_id,
      thread_type=self.thread_type
    )

  def define_documentation(self):
    self.documentation = {
    "parameters": "NONE",
    "function": "Greets the user with a friendly hello."
    }
                  </code></pre>
                </div>
                <p><b><i>Remember to save your changes to the file!</i></b></p>
                <h2 id="third" class="text-center">Running the bot</h2>
                <p>Open a terminal window and make sure that you are in the venv of Dentaku. Enter the following to run Dentaku.</p>
                <div class="codeheader codeheader-bash">BASH</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
python main.py
                    </code></pre>
                </div>
                <p>
                  Once you see 'Listening...' in your terminal output, that means that the bot is successfully running.
                  Try sending '!greet' to the account you have ran it on to see what happens. You can also try '!help !greet'.
                </p>
                <p>
                  You will notice that you cannot enter any commands into your Terminal window while Dentaku is running.
                  If you have made new changes after running Dentaku, you will need to stop the current process and restart it
                  to see the changes take effect. <b>NEVER RUN MORE THAN ONE INSTANCE OF DENTAKU AT ONCE.</b> Try to limit the
                  times you restart Dentaku, as Facebook may label frequent restarts as suspicious. To stop running Dentaku,
                  press <code>CTRL-C</code>. You may have to press it more than once to return to your command line.
                </p>
                <br>
                <h2 id="fourth" class="text-center">Pushing the command</h2>
                <p>
                  Once you are satisfied with your command, stop running Dentaku. In order to add your changes to GitHub, you need to commit and then push your changes.
                  Enter the following commands in Terminal. You may have to enter your GitHub email and password if prompted.
                  <i>NOTE: The first line is only necessary when you create a new file. If you only changed existing files, you will not need to add the file to git.</i>
                </p>
                <div class="codeheader codeheader-bash">BASH</div>
                <div class="codebox">
                    <pre><code data-language="python">
                    <p style="color: #fff;">
git add greet.py
git commit -m "COMMIT_MESSAGE"
git push
                    </code></pre>
                </div>
                <p>
                  Your commit message should be a description of what you have added. Make sure that it is in the imperative form, as if you are
                  giving instructions.
                <br><i>
                  Ex: "Add greet command", <b>NOT</b> "I added !greet" or "Adds a greet command".
                </i></p>
                <p>Make sure to keep your fork up to date! You will need to do this by running ./pull-fork.sh in Terminal.
                <b>You should always update your fork before making changes to prevent merge conflicts.</b></p>
                <p>
                  After committing and pushing your changes, you will need to make a pull request to the 'dev' branch of the main VikingsDev repository.
                  To do so, click the green 'New pull request' button in the "Pull requests" tab.
                </p>
                <img style="width:100%" src="dentaku-assets/pull-request.png">
                <br><br>
                <p>If you do not see an option to change the head and base repositories, click 'compare across forks'.</p>
                <img style="width:100%" src="dentaku-assets/pull-fork.png">
                <br><br>
                <p>
                  Make sure that the BASE repository is VikingsDev/Dentaku and the base branch is 'dev'.
                  The HEAD repository should be your fork and the branch is 'master'.
                </p>
                <img style="width:100%" src="dentaku-assets/pull-branch.png">
                <br><br>
                <p>
                  Title your pull request in the same way you write your commit message and make sure it sums up what your
                  pull request adds to Dentaku. When you are ready, click the green 'Create Pull Request' button and wait for approval.
                </p>
                <p>
                  Congratulations, you have now completed the workshop! To have your pull request approved, you will need to create your own command
                  (or improve an existing one). Please do NOT try to add greet.py to Dentaku, we do not need the command in our bot.
                  Make sure that you delete the file before you push your commits so that it does not get accidentally added to GitHub. You can type
                  <code>git rm greet.py</code> and then use <code>git commit</code> and <code>git push</code> if you need to remove it from GitHub.
                </p>
                <p>
                  This project is eligible for VikingsDev Bounties. Click the button below to learn more.
                </p>
                <p class="text-center"><a target="_blank" href="https://vikingsdev.ca/bounties.html" class="btn btn-primary py-3">What's a Bounty?</a></p>
                <br><br>
                <p class="text-center"><a href="../workshops.html"
                                          class="btn btn-primary py-3">Back to Workshops</a></p>
            </div>
        </div>
        <br>
    </div>
</section>

<footer class="ftco-footer ftco-bg-dark ftco-section">
    <div class="container">
        <div class="row mb-5 pb-5 align-items-center d-flex">
            <div class="col-md-6">
                <div class="heading-section heading-section-white ftco-animate">
                    <span class="subheading">Get Inspired</span>
                    <h2 style="font-size: 30px;">Join VikingsDev Today!</h2>
                </div>
            </div>
            <div class="col-md-3 ftco-animate">
                <p class="mb-0"><a href="../signup.html" class="btn btn-primary py-3 px-4"
                                   style="background:#9c6d41; border: 0px;">Sign Up</a></p>
            </div>
        </div>
        <div class="row mb-5">
            <div class="col-md">
                <div class="ftco-footer-widget mb-4 bg-primary p-4">
                    <h2 class="ftco-heading-2">VikingsDev</h2>
                    <p>This website was built for the VikingsDev club at Burnaby North Secondary School.</p>
                    <ul class="ftco-footer-social list-unstyled mb-0">
                        <li class="ftco-animate"><a href="https://twitter.com/vikings_dev"><span
                                class="icon-twitter"></span></a></li>
                        <li class="ftco-animate"><a href="https://www.facebook.com/groups/vikingsdev"><span
                                class="icon-facebook"></span></a></li>
                        <li class="ftco-animate"><a href="https://www.instagram.com/vikingsdev/"><span
                                class="icon-instagram"></span></a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <h2 class="ftco-heading-2">Navigational</h2>
                    <ul class="list-unstyled">
                        <li><a href="../index.html" class="py-2 d-block">Home</a></li>
                        <li><a href="../about.html" class="py-2 d-block">About</a></li>
                        <li><a href="../events.html" class="py-2 d-block">Events</a></li>
                        <li><a href="../workshops.html" class="py-2 d-block">Workshops</a></li>
                        <li><a href="../contact.html" class="py-2 d-block">Contact</a></li>
                        <li><a href="../signup.html" class="py-2 d-block">Sign Up</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md">
                <div class="ftco-footer-widget mb-4">
                    <h2 class="ftco-heading-2">Find Us</h2>
                    <div class="block-23 mb-3">
                        <ul>
                            <li><span class="icon icon-map-marker"></span><span class="text">751 Hammarskjold Dr, Burnaby, BC V5B 4A1, Canada</span>
                            </li>
                            <li><a href="#"><span class="icon icon-envelope"></span><span class="text">vikingsdev@gmail.com</span></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center">
                <p>Hosted on <a href="https://github.com/VikingsDev/VikingsDev.github.io">Github</a>. Made by <a
                        href="https://github.com/FrankWhoee">Frank Hui</a></p>
                <p>Based on the <a href="https://colorlib.com/wp/template/cohost/">CoHost ColorLib Template</a></p>
            </div>
        </div>
    </div>
</footer>


<!-- loader -->
<div id="ftco-loader" class="show fullscreen">
    <svg class="circular" width="48px" height="48px">
        <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/>
        <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                stroke="#F96D00"/>
    </svg>
</div>


<script src="../js/jquery.min.js"></script>
<script src="../js/jquery-migrate-3.0.1.min.js"></script>
<script src="../js/popper.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/jquery.easing.1.3.js"></script>
<script src="../js/jquery.waypoints.min.js"></script>
<script src="../js/jquery.stellar.min.js"></script>
<script src="../js/owl.carousel.min.js"></script>
<script src="../js/jquery.magnific-popup.min.js"></script>
<script src="../js/aos.js"></script>
<script src="../js/jquery.animateNumber.min.js"></script>
<script src="../js/bootstrap-datepicker.js"></script>
<script src="../js/jquery.timepicker.min.js"></script>
<script src="../js/scrollax.min.js"></script>
<script src="../js/google-map.js"></script>
<script src="../js/main.js"></script>

</body>
</html>
